+++
title = "Руководство по настройке и прошивке клавиатуры с Ergohaven's Qube"
tags = ["guide", "zmk", "qube", "ergohaven"]
+++

В этом руководстве мы подробно разберем процесс полной настройки и прошивки сплит-клавиатуры Ergohaven с использованием донгла Qube. Вы узнаете, как подготовить файлы, выполнить полный сброс и правильно прошить все компоненты для стабильной работы.

**Ergohaven's Qube** — это универсальный девайс создан для того, чтобы стать незаменимым помощником для беспроводных клавиатур. Работает как донгл, отображает полезную информацию, а также снижает энергопотребление вашей клавиатуры

![image](/images/qube/qubes.png)

## Шаг 1: Подготовка прошивки

Прежде чем начать, вам нужно получить актуальные файлы прошивки. Файл прошивки — это, по сути, «мозг» вашей клавиатуры, который определяет, как она работает.

1. **Если у вас есть форк (копия) репозитория на GitHub:** Синхронизируйте ваш форк с основным репозиторием ZMK, чтобы получить последние обновления. После этого соберите (скомпилируйте) прошивку и скачайте получившиеся `*.uf2` файлы: по одному для левой и правой половинок, и один для донгла Qube.

2. **Если у вас нет своего форка:** Скачайте готовую стандартную прошивку из репозитория <a href="https://github.com/ergohaven/keymap_hub" target="_blank">ergohaven/keymap_hub</a> Вам также понадобятся три `.uf2` файла.

Дополнительно вам потребуется **Reset прошивка** (`settings_reset-ergohaven-zmk.uf2`). Обычно её можно найти там же, где и основную прошивку, или у нас в <a href="https://github.com/ergohaven/keymap_hub" target="_blank">keymap_hub</a>.

![image](/images/qube/keymap_hub.png)

## Шаг 2: Полный сброс настроек

> Этот шаг необходим для «чистой» установки и для того, чтобы избежать конфликтов между старой и новой прошивками. Мы последовательно установим прошивку-сброса на все три устройства.

1.  **Отключите питание на обеих половинках клавиатуры.** Для этого используйте физические переключатели на нижней части корпуса.

![image](/images/qube/buttons.png)

2.  **Прошейте Reset прошивкой.** Подключите по очереди каждое из трёх устройств (левая половинка, правая половинка, Qube) к компьютеру. После подключения, дважды быстро нажмите кнопку сброса Reset на задней поверхности, для перевода его в режим загрузчика. Устройство появится в системе как съёмный USB-накопитель. Перетащите файл прошивки-сброса (`settings_reset-ergohaven-zmk.uf2`) на этот накопитель. После копирования устройство автоматически перезагрузится.

> Уведомление об ошибке при копировании файла прошивки или некорректном извлечении устройства - это нормально. Файл успешно передаётся, но накопитель отключается до того, как операционная система успевает подтвердить завершение операции. 

## Шаг 3: Прошивка

> Теперь, когда все устройства сброшены, можно устанавливать основную прошивку. **Порядок здесь важен!**

1.  **Прошейте Qube.** Подключите донгл к компьютеру, переведите его в режим загрузчика и скопируйте на него соответствующий файл прошивки (`op36_qube-ergohaven-zmk.uf2` или аналогичный).
2.  **Отключите Qube от компьютера.**
3.  **Прошейте левую половинку.** Подключите левую половинку клавиатуры, переведите её в режим загрузчика и скопируйте на неё файл прошивки для левой стороны (`op36_left_qube-ergohaven-zmk.uf2`).
> Для прошивки левой половинки клавиатуры используйте исключительно файл прошивки с названием <code><b>left_qube</b>-ergohaven-zmk.uf2</code>. Исключением является Velvet UI -  у него для левой половинки прошивка: <code><b>ui_left</b>-ergohaven-zmk.uf2</code>, а для правой: <code><b>ui_right_qube</b>-ergohaven-zmk.uf2</code>

4.  **Отключите левую половинку от компьютера.**
5.  **Прошейте правую половинку.** Подключите правую половинку, переведите в режим загрузчика и скопируйте на неё её файл прошивки (`op36_right-ergohaven-zmk.uf2`).

## Шаг 4: Первое включение и синхронизация

Все компоненты прошиты. Теперь их нужно правильно запустить.

1.  **Используя Type-C кабель подключите Ergohaven's Qube к компьютеру.** Он будет действовать как приёмник.
2.  **Включите питание на левой половинке клавиатуры.** Она должна автоматически подключиться к Qube.
3.  **Включите питание на правой половинке.** Она также подключится к Qube, завершая настройку.

Подождите несколько секунд. Попробуйте напечатать что-нибудь. Если всё сделано правильно, ваша клавиатура готова к работе!
> Если ничего не происходит, то нажмите один раз на кнопку сброса на Qube.

![image](/images/qube/op36_qube.png)

## Как обновлять раскладку в будущем?

> В этом заключается одно из главных преимуществ использования Ergohaven's Qube. Вся логика раскладки клавиатуры хранится именно в нём.

Если вы изменили свою раскладку (поменяли клавиши местами, добавили макрос) и собрали новую прошивку, вам **не нужно** заново прошивать половинки клавиатуры.
Достаточно перепрошить только донгл! Просто подключите его к компьютеру, переведите его в режим загрузчика и скопируйте на него новый файл прошивки. Половинки клавиатуры трогать не нужно. Это делает процесс обновления быстрым и удобным.

**Поздравляем! Ваша клавиатура полностью настроена и готова к работе.**
